---
import card_01 from "@/assets/images/card_01.png";
import card_01_postpago from "@/assets/images/card_01_postpago.png";
import card_02 from "@/assets/images/card_02.png";
import card_03 from "@/assets/images/card_03.png";
import CardSlider from "./CardSlider.astro";

const prepagoCards = [
  {
    image: card_01.src,
    alt: "Paso 1 Prepago",
    step: 1,
    title: "Realiza una recarga desde S/ 7 o adquiere un paquete de alta, portabilidad o renovación para participar.",
  },
  {
    image: card_02.src,
    alt: "Paso 2 Prepago",
    step: 2,
    title: "Ingresa tus datos y valida tu línea Claro.",
  },
  {
    image: card_03.src,
    alt: "Paso 3 Prepago",
    step: 3,
    title: "¡Gira la ruleta y gana premios al instante!",
  },
];

const postpagoCards = [
  {
    image: card_02.src,
    alt: "Paso 1 Postpago",
    step: 1,
    title: "Ingresa tus datos y valida tu línea Claro.",
  },
  {
    image: card_03.src,
    alt: "Paso 2 Postpago",
    step: 2,
    title: "¡Gira la ruleta y participa por grandes premios!.",
  },
  {
    image: card_01_postpago.src,
    alt: "Paso 3 Postpago",
    step: 3,
    title: "Si eres uno de los ganadores, te contactaremos a tu línea Claro registrada.",
  },
];
---

<section class="relative pt-36 lg:pt-14 xl:pt-40 bg-transparent z-10 text-white">
  <div class="container">
    <h2 class="text-center font-amx-bold text-3xl xl:text-4xl pb-6 md:pb-8">¡Participar es muy fácil!</h2>
    <div class="tabs-container hidden justify-center gap-4 pt-8 pb-8 md:max-w-[500px] mx-auto" role="tablist" aria-label="Tipo de plan">
      <button
        class="tab-btn w-full px-6 py-3 rounded-full font-amx-bold text-lg transition-all duration-300 bg-transparent text-primary border-2 border-white shadow-lg cursor-pointer"
        data-tab="prepago"
        role="tab"
        aria-selected="true"
      >
        Prepago
      </button>
      <button
        class="tab-btn w-full px-6 py-3 rounded-full font-amx-bold text-lg transition-all duration-300 bg-white/30 border-2 border-transparent text-white/70 cursor-pointer"
        data-tab="postpago"
        role="tab"
        aria-selected="false"
      >
        Postpago
      </button>
    </div>

    <div class="tab-content" data-content="postpago" role="tabpanel">
      <CardSlider cards={postpagoCards} tabId="postpago" />
    </div>
  </div>
</section>

<script>
  const tabButtons = document.querySelectorAll(".tab-btn");
  const tabContents = document.querySelectorAll(".tab-content");

  tabButtons.forEach((btn) => {
    btn.addEventListener("click", () => {
      const tabName = btn.getAttribute("data-tab");
      if (!tabName) return;

      tabButtons.forEach((b) => {
        const isActive = b === btn;
        b.setAttribute("aria-selected", isActive ? "true" : "false");
        b.classList.toggle("bg-transparent", isActive);
        b.classList.toggle("text-primary", isActive);
        b.classList.toggle("border-white", isActive);
        b.classList.toggle("shadow-lg", isActive);
        b.classList.toggle("bg-transparent", !isActive);
        b.classList.toggle("bg-white/30", !isActive);
        //b.classList.toggle("border-transparent", !isActive);
        b.classList.toggle("border-transparent", !isActive);
        b.classList.toggle("text-white/70", !isActive);
      });

      tabContents.forEach((content) => {
        const isTarget = content.getAttribute("data-content") === tabName;
        content.classList.toggle("hidden", !isTarget);
        content.setAttribute("aria-hidden", isTarget ? "false" : "true");

        // Cuando un tab pasa a ser visible, disparar animación de entrada de cards en desktop
        if (isTarget) {
          const slider = content.querySelector(".card-slider");
          if (slider) {
            slider.dispatchEvent(new CustomEvent("cards:enter"));
          }
        }
      });
    });
  });
</script>
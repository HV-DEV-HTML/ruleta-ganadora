---
import "swiper/css/bundle";
---

<section class="relative pt-0 bg-transparent z-10 text-white">
  <div class="container">
    <h2 class="text-center font-amx-bold text-2xl md:text-3xl xl:text-4xl">¡Participar es muy fácil!</h2>
    <!-- Swiper para mobile/tablet -->
    <div class="swiper slider_participa w-[250px] h-[450px] py-10 lg:hidden mx-auto">
      <div class="swiper-wrapper">
        <div class="swiper-slide rounded-2xl overflow-hidden">
          <img class="w-full h-full object-cover absolute inset-0" src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/b6f5eb64-887c-43b1-aaba-d52a4c59a379" alt="">
        </div>
        <div class="swiper-slide rounded-2xl overflow-hidden">
          <img class="w-full h-full object-cover absolute inset-0" src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/e906353b-fde0-4518-9a03-16545c1161bd" alt="">
        </div>
        <div class="swiper-slide rounded-2xl overflow-hidden">
          <img class="w-full h-full object-cover absolute inset-0" src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/fc21e481-e28a-41a8-9db3-3b62c1ddc17e" alt="">
        </div>
      </div>
      <div class="swiper-button-next" style="--swiper-navigation-sides-offset: -60px"></div>
      <div class="swiper-button-prev" style="--swiper-navigation-sides-offset: -60px"></div>
    </div>

    <!-- Cards estáticos para desktop -->
    <div class="hidden lg:flex justify-center items-center gap-6 py-10">
      <div class="w-[280px] xl:w-[320px] h-[400px] xl:h-[450px] rounded-2xl overflow-hidden shadow-2xl transform translate-x-14 -rotate-6 hover:rotate-0 hover:scale-108 transition-transform duration-300">
        <img class="w-full h-full object-cover" src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/b6f5eb64-887c-43b1-aaba-d52a4c59a379" alt="Paso 1">
      </div>
      <div class="w-[280px] xl:w-[320px] h-[400px] xl:h-[450px] rounded-2xl overflow-hidden shadow-2xl z-10 transition-all duration-300 hover:scale-108">
        <img class="w-full h-full object-cover" src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/e906353b-fde0-4518-9a03-16545c1161bd" alt="Paso 2">
      </div>
      <div class="w-[280px] xl:w-[320px] h-[400px] xl:h-[450px] rounded-2xl overflow-hidden shadow-2xl transform -translate-x-14 rotate-6 hover:rotate-0 hover:scale-108 transition-transform duration-300">
        <img class="w-full h-full object-cover" src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/fc21e481-e28a-41a8-9db3-3b62c1ddc17e" alt="Paso 3">
      </div>
    </div>

    <!-- Textos de pasos -->
    <div class="flex flex-col md:flex-row justify-center xl:justify-between items-start gap-4 lg:gap-10 px-4 slider_participa_steps">
      <div class="flex flex-col gap-1 hidden md:flex w-full md:max-w-[210px] xl:max-w-[320px]" data-step="1">
        <p class="text-center font-amx-black text-3xl">Paso 1</p>
        <p class="text-center md:text-xs xl:text-lg leading-tight font-amx-regular text-balance">Realiza una recarga desde S/ 7 o adquiere un paquete de alta, portabilidad o renovación para participar.</p>
      </div>
      <div class="flex flex-col gap-1 hidden md:flex w-full md:max-w-[210px] xl:max-w-[320px]" data-step="2">
        <p class="text-center font-amx-black text-3xl">Paso 2</p>
        <p class="text-center md:text-xs xl:text-lg leading-tight font-amx-regular text-balance">Ingresa tus datos y valida tu línea Claro.</p>
      </div>
      <div class="flex flex-col gap-1 hidden md:flex w-full md:max-w-[210px] xl:max-w-[320px]" data-step="3">
        <p class="text-center font-amx-black text-3xl">Paso 3</p>
        <p class="text-center md:text-xs xl:text-lg leading-tight font-amx-regular text-balance">¡Gira la ruleta y gana premios al instante!</p>
      </div>
    </div>
  </div>
</section>

<script>
  import Swiper from "swiper/bundle";
  
  // Solo inicializar Swiper en mobile/tablet
  if (window.innerWidth < 1024) {
    const sliderParticipaSteps = document.querySelector(".slider_participa_steps") as HTMLElement;
    const sliderParticipa = new Swiper(".slider_participa", {
        effect: "cards",
        cardsEffect: {
          rotate: true,
          perSlideOffset: 10,
          perSlideRotate: 4,
          slideShadows: true,
        },
        grabCursor: true,
        speed: 500,
        loop: false,
        mousewheel: {
          invert: false,
        },
        navigation: {
          nextEl: ".slider_participa .swiper-button-next",
          prevEl: ".slider_participa .swiper-button-prev",
        },
        on: {
          init: function () {
            const currentStep = this.realIndex + 1;
            sliderParticipaSteps.querySelector(`[data-step="${currentStep}"]`)?.classList.remove("hidden");
          },
        },
    });
    
    sliderParticipa.on("slideChange", () => {
      const currentStep = sliderParticipa.realIndex + 1;
      sliderParticipaSteps.querySelectorAll(`[data-step]`).forEach(step => {
        step.classList.add("hidden");
      });
      sliderParticipaSteps.querySelector(`[data-step="${currentStep}"]`)?.classList.remove("hidden");
    });
  } else {
    // En desktop, mostrar todos los pasos
    const sliderParticipaSteps = document.querySelector(".slider_participa_steps") as HTMLElement;
    sliderParticipaSteps.querySelectorAll(`[data-step]`).forEach(step => {
      step.classList.remove("hidden");
    });
  }
</script>